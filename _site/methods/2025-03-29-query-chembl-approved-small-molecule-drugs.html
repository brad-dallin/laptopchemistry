<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Query Chembl for Approved Small Molecule Drugs | Laptop Chemistry</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Query Chembl for Approved Small Molecule Drugs" />
<meta name="author" content="Brad Dallin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I created this Notebook to document some of my learnings by building a SQL query that retrives the chemical structures and data from the Chembl database. Prior to running, I already downloaded the Chembl database and hosted it locally using the Postgres App for Mac." />
<meta property="og:description" content="I created this Notebook to document some of my learnings by building a SQL query that retrives the chemical structures and data from the Chembl database. Prior to running, I already downloaded the Chembl database and hosted it locally using the Postgres App for Mac." />
<link rel="canonical" href="http://localhost:4000/methods/2025-03-29-query-chembl-approved-small-molecule-drugs.html" />
<meta property="og:url" content="http://localhost:4000/methods/2025-03-29-query-chembl-approved-small-molecule-drugs.html" />
<meta property="og:site_name" content="Laptop Chemistry" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-03-29T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Query Chembl for Approved Small Molecule Drugs" />
<meta name="google-site-verification" content="22adf0f0c4ae7864" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Brad Dallin"},"dateModified":"2025-03-29T00:00:00-04:00","datePublished":"2025-03-29T00:00:00-04:00","description":"I created this Notebook to document some of my learnings by building a SQL query that retrives the chemical structures and data from the Chembl database. Prior to running, I already downloaded the Chembl database and hosted it locally using the Postgres App for Mac.","headline":"Query Chembl for Approved Small Molecule Drugs","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/methods/2025-03-29-query-chembl-approved-small-molecule-drugs.html"},"url":"http://localhost:4000/methods/2025-03-29-query-chembl-approved-small-molecule-drugs.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Laptop Chemistry" />
</head>
<body><header class="site-header">

  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Laptop Chemistry</a>
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon fas fa-bars fa-lg"></span>
        </label>

        <div class="drawer-container">
          <div class="drawer"><a class="nav-item" href="/">Home</a>
    <a class="nav-item" href="/methods">Methods</a>
    <a class="nav-item" href="/about">About</a>
          </div>
        </div>
        <div class="slab"><a class="nav-item" href="/">Home</a>
    <a class="nav-item" href="/methods">Methods</a>
    <a class="nav-item" href="/about">About</a>
        </div>
      </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Query Chembl for Approved Small Molecule Drugs</h1>
    <div class="post-meta">
      <time class="dt-published" datetime="2025-03-29T00:00:00-04:00" itemprop="datePublished">
        Mar 29, 2025
      </time>
        <div class="force-inline post-authors">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Brad Dallin</span></span>
        </div><div class="post-meta">
          
        </div></div>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I created this Notebook to document some of my learnings by building a SQL query that retrives the chemical structures and data from the Chembl database. Prior to running, I already downloaded the Chembl database and hosted it locally using the Postgres App for Mac.</p>

<p>Instructions for downloading the Chembl database can be found <a href="https://chembl.gitbook.io/chembl-interface-documentation/downloads">here</a> and installation instructions for Postgres App <a href="https://postgresapp.com">here</a>.</p>

<h3 id="1-import-modules"><strong>1. Import modules</strong></h3>

<p>I prefer working with the pandas and adbc_driver_postgresql modules for Postgres queries and dataframes. By default, pandas truncates the number of columns printed. I adjusted the max column setting to print all columns.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Import modules
</span><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">adbc_driver_postgresql</span>
<span class="kn">import</span> <span class="n">adbc_driver_postgresql.dbapi</span>

<span class="c1"># Expand to see all columns
</span><span class="n">pd</span><span class="p">.</span><span class="nf">set_option</span><span class="p">(</span><span class="sh">'</span><span class="s">display.max_columns</span><span class="sh">'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

<span class="c1"># Print versions
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Pandas Version: </span><span class="si">{</span><span class="n">pd</span><span class="p">.</span><span class="n">__version__</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ADBC Driver Version: </span><span class="si">{</span><span class="n">adbc_driver_postgresql</span><span class="p">.</span><span class="n">__version__</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Pandas Version: 2.2.3
ADBC Driver Version: 1.5.0
</code></pre></div></div>

<h3 id="2-test-connection-to-postgresql">2. <strong>Test Connection to PostgreSQL</strong></h3>

<p>I set the URI hosting the Chembl database on my localhost. I used a very basic SQL query to test the connection to Postgres.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">uri</span> <span class="o">=</span> <span class="sh">"</span><span class="s">postgresql://localhost/Chembl35</span><span class="sh">"</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">adbc_driver_postgresql</span><span class="p">.</span><span class="n">dbapi</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
        <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT 1</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">cur</span><span class="p">.</span><span class="nf">fetchone</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Database connected successfully</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Database not connected successfully</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Database connected successfully
</code></pre></div></div>

<h3 id="3-preview-all-available-tables-in-chembl35-database">3. <strong>Preview All Available Tables in Chembl35 Database</strong></h3>

<p>The Chembl database contains a lot of data which has been split into separate tables. I often need to query and merge multiple tables to get all the data needed. I ran this command to list all the available tables in Chembl.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sql_list_tables</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
SELECT table_name
FROM information_schema.tables
    WHERE table_schema = </span><span class="sh">'</span><span class="s">public</span><span class="sh">'</span><span class="s">
ORDER BY table_name
</span><span class="sh">"""</span>
<span class="k">with</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
    <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_list_tables</span><span class="p">)</span>
    <span class="n">chembl_tables_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="n">cur</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">(),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">description</span><span class="p">]</span>
    <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">chembl_tables_df</span><span class="p">[</span><span class="sh">"</span><span class="s">table_name</span><span class="sh">"</span><span class="p">].</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['action_type' 'activities' 'activity_properties' 'activity_smid'
 'activity_stds_lookup' 'activity_supp' 'activity_supp_map'
 'assay_class_map' 'assay_classification' 'assay_parameters' 'assay_type'
 'assays' 'atc_classification' 'binding_sites' 'bio_component_sequences'
 'bioassay_ontology' 'biotherapeutic_components' 'biotherapeutics'
 'cell_dictionary' 'chembl_id_lookup' 'chembl_release' 'component_class'
 'component_domains' 'component_go' 'component_sequences'
 'component_synonyms' 'compound_properties' 'compound_records'
 'compound_structural_alerts' 'compound_structures'
 'confidence_score_lookup' 'curation_lookup' 'data_validity_lookup'
 'defined_daily_dose' 'docs' 'domains' 'drug_indication' 'drug_mechanism'
 'drug_warning' 'formulations' 'frac_classification' 'go_classification'
 'hrac_classification' 'indication_refs' 'irac_classification'
 'ligand_eff' 'mechanism_refs' 'metabolism' 'metabolism_refs'
 'molecule_atc_classification' 'molecule_dictionary'
 'molecule_frac_classification' 'molecule_hierarchy'
 'molecule_hrac_classification' 'molecule_irac_classification'
 'molecule_synonyms' 'organism_class' 'patent_use_codes'
 'predicted_binding_domains' 'product_patents' 'products'
 'protein_class_synonyms' 'protein_classification' 'relationship_type'
 'research_companies' 'research_stem' 'site_components' 'source'
 'structural_alert_sets' 'structural_alerts' 'target_components'
 'target_dictionary' 'target_relations' 'target_type' 'tissue_dictionary'
 'usan_stems' 'variant_sequences' 'version' 'warning_refs']
</code></pre></div></div>

<h3 id="4-preview-all-columns-in-compound-structures-table">4. <strong>Preview All Columns in Compound Structures Table</strong></h3>

<p>To see which columns are available in the compound structures table, I ran this query. Canonical SMILES are available in this table as well.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sql_table</span> <span class="o">=</span> <span class="sh">"</span><span class="s">compound_structures</span><span class="sh">"</span>
<span class="n">sql_list_columns</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
SELECT column_name
FROM information_schema.columns
    WHERE table_name = </span><span class="sh">'</span><span class="s">compound_records</span><span class="sh">'</span><span class="s">
ORDER BY ordinal_position
</span><span class="sh">"""</span>
<span class="k">with</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
    <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_list_columns</span><span class="p">)</span>
    <span class="n">chembl_columns_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="n">cur</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">(),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">description</span><span class="p">]</span>
    <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Table name: </span><span class="si">{</span><span class="n">sql_table</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Columns: </span><span class="si">{</span><span class="n">chembl_columns_df</span><span class="p">[</span><span class="sh">"</span><span class="s">column_name</span><span class="sh">"</span><span class="p">].</span><span class="n">values</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table name: compound_structures
Columns: ['record_id' 'molregno' 'doc_id' 'compound_key' 'compound_name' 'src_id'
 'src_compound_id' 'cidx']
</code></pre></div></div>

<h3 id="5-preview-all-columns-in-molecule-dictionary">5. <strong>Preview All Columns in Molecule Dictionary</strong></h3>

<p>To see which columns are available in the molecule dictionary table, I ran this query. The molecule dictionary table contains much of the data about the drug information.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sql_table</span> <span class="o">=</span> <span class="sh">"</span><span class="s">molecule_dictionary</span><span class="sh">"</span>
<span class="n">sql_list_columns</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
SELECT column_name
FROM information_schema.columns
    WHERE table_name = </span><span class="sh">'</span><span class="s">molecule_dictionary</span><span class="sh">'</span><span class="s">
ORDER BY ordinal_position
</span><span class="sh">"""</span>
<span class="k">with</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
    <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_list_columns</span><span class="p">)</span>
    <span class="n">chembl_columns_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="n">cur</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">(),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">description</span><span class="p">]</span>
    <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Table name: </span><span class="si">{</span><span class="n">sql_table</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Columns: </span><span class="si">{</span><span class="n">chembl_columns_df</span><span class="p">[</span><span class="sh">"</span><span class="s">column_name</span><span class="sh">"</span><span class="p">].</span><span class="n">values</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table name: molecule_dictionary
Columns: ['molregno' 'pref_name' 'chembl_id' 'max_phase' 'therapeutic_flag'
 'dosed_ingredient' 'structure_type' 'chebi_par_id' 'molecule_type'
 'first_approval' 'oral' 'parenteral' 'topical' 'black_box_warning'
 'natural_product' 'first_in_class' 'chirality' 'prodrug' 'inorganic_flag'
 'usan_year' 'availability_type' 'usan_stem' 'polymer_flag' 'usan_substem'
 'usan_stem_definition' 'indication_class' 'withdrawn_flag'
 'chemical_probe' 'orphan']
</code></pre></div></div>

<h3 id="6-preview-all-columns-in-compound-properties">6. <strong>Preview All Columns in Compound Properties</strong></h3>

<p>To see which columns are available in the compound properties table, I ran this query. Compound properties are mostly physicochemical properties of the molecule.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sql_table</span> <span class="o">=</span> <span class="sh">"</span><span class="s">compound_properties</span><span class="sh">"</span>
<span class="n">sql_list_columns</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
SELECT column_name
FROM information_schema.columns
    WHERE table_name = </span><span class="sh">'</span><span class="s">compound_properties</span><span class="sh">'</span><span class="s">
ORDER BY ordinal_position
</span><span class="sh">"""</span>
<span class="k">with</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
    <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_list_columns</span><span class="p">)</span>
    <span class="n">chembl_columns_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="n">cur</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">(),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">description</span><span class="p">]</span>
    <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Table name: </span><span class="si">{</span><span class="n">sql_table</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Columns: </span><span class="si">{</span><span class="n">chembl_columns_df</span><span class="p">[</span><span class="sh">"</span><span class="s">column_name</span><span class="sh">"</span><span class="p">].</span><span class="n">values</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table name: compound_properties
Columns: ['molregno' 'mw_freebase' 'alogp' 'hba' 'hbd' 'psa' 'rtb' 'ro3_pass'
 'num_ro5_violations' 'cx_most_apka' 'cx_most_bpka' 'cx_logp' 'cx_logd'
 'molecular_species' 'full_mwt' 'aromatic_rings' 'heavy_atoms'
 'qed_weighted' 'mw_monoisotopic' 'full_molformula' 'hba_lipinski'
 'hbd_lipinski' 'num_lipinski_ro5_violations' 'np_likeness_score']
</code></pre></div></div>

<h3 id="7-query-chembl-database-for-small-molecule-drugs-and-merge-tables">7. <strong>Query Chembl Database for Small Molecule Drugs and Merge Tables</strong></h3>

<p>I took the information about the columns above and combined it into a query/filter for small molecule drugs. It may be little excessive to include all columns, but this is how you could keep all the data. I often find it easier to filter data later on, rather than go back to retreive or generate the data again.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sql_query</span><span class="o">=</span><span class="sh">"""</span><span class="s">
SELECT DISTINCT m.chembl_id AS molecule_chembl_id,
s.canonical_smiles AS smiles,
-- Molecule Dictionary
m.molregno, m.pref_name, m.max_phase, m.therapeutic_flag, m.dosed_ingredient,
m.structure_type, m.chebi_par_id, m.molecule_type, m.first_approval, m.oral,
m.parenteral, m.topical, m.black_box_warning, m.natural_product, m.first_in_class,
m.chirality, m.prodrug, m.inorganic_flag, m.usan_year, m.availability_type,
m.usan_stem, m.polymer_flag, m.usan_substem, m.usan_stem_definition,
m.indication_class, m.withdrawn_flag, m.chemical_probe, m.orphan,
-- Compound Properties
p.mw_freebase, p.alogp, p.hba, p.hbd, p.psa, p.rtb, p.ro3_pass,
p.num_ro5_violations, p.cx_most_apka, p.cx_most_bpka, p.cx_logp,
p.cx_logd, p.molecular_species, p.full_mwt, p.aromatic_rings,
p.heavy_atoms, p.qed_weighted, p.mw_monoisotopic, p.full_molformula,
p.hba_lipinski, p.hbd_lipinski, p.num_lipinski_ro5_violations,
p.np_likeness_score
-- Join tables
FROM compound_structures s
    RIGHT JOIN compound_properties p ON s.molregno = p.molregno
    RIGHT JOIN molecule_dictionary m ON p.molregno = m.molregno
    JOIN compound_records r ON m.molregno = r.molregno
    AND m.max_phase = 4
    AND m.molecule_type = </span><span class="sh">'</span><span class="s">Small molecule</span><span class="sh">'</span><span class="s">
    AND m.inorganic_flag = 0
ORDER BY m.first_approval ASC
</span><span class="sh">"""</span>
<span class="k">with</span> <span class="n">conn</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
    <span class="n">cur</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_query</span><span class="p">)</span>
    <span class="n">chembl_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span>
        <span class="n">cur</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">(),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">description</span><span class="p">]</span>
    <span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">chembl_df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">chembl_df</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(3517, 53)
</code></pre></div></div>

<div style="overflow-x: auto; width: 100%;">
    <style scoped="">
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
        <thead>
            <tr style="text-align: right;">
            <th></th>
            <th>molecule_chembl_id</th>
            <th>smiles</th>
            <th>molregno</th>
            <th>pref_name</th>
            <th>max_phase</th>
            <th>therapeutic_flag</th>
            <th>dosed_ingredient</th>
            <th>structure_type</th>
            <th>chebi_par_id</th>
            <th>molecule_type</th>
            <th>first_approval</th>
            <th>oral</th>
            <th>parenteral</th>
            <th>topical</th>
            <th>black_box_warning</th>
            <th>natural_product</th>
            <th>first_in_class</th>
            <th>chirality</th>
            <th>prodrug</th>
            <th>inorganic_flag</th>
            <th>usan_year</th>
            <th>availability_type</th>
            <th>usan_stem</th>
            <th>polymer_flag</th>
            <th>usan_substem</th>
            <th>usan_stem_definition</th>
            <th>indication_class</th>
            <th>withdrawn_flag</th>
            <th>chemical_probe</th>
            <th>orphan</th>
            <th>mw_freebase</th>
            <th>alogp</th>
            <th>hba</th>
            <th>hbd</th>
            <th>psa</th>
            <th>rtb</th>
            <th>ro3_pass</th>
            <th>num_ro5_violations</th>
            <th>cx_most_apka</th>
            <th>cx_most_bpka</th>
            <th>cx_logp</th>
            <th>cx_logd</th>
            <th>molecular_species</th>
            <th>full_mwt</th>
            <th>aromatic_rings</th>
            <th>heavy_atoms</th>
            <th>qed_weighted</th>
            <th>mw_monoisotopic</th>
            <th>full_molformula</th>
            <th>hba_lipinski</th>
            <th>hbd_lipinski</th>
            <th>num_lipinski_ro5_violations</th>
            <th>np_likeness_score</th>
            </tr>
        </thead>
        <tbody>
            <tr>
            <th>0</th>
            <td>CHEMBL1200542</td>
            <td>CC(=O)OCC(=O)[C@H]1CC[C@H]2[C@@H]3CCC4=CC(=O)C...</td>
            <td>674493</td>
            <td>DESOXYCORTICOSTERONE ACETATE</td>
            <td>4.0</td>
            <td>1</td>
            <td>1</td>
            <td>MOL</td>
            <td>34671.0</td>
            <td>Small molecule</td>
            <td>1939.0</td>
            <td>0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>1</td>
            <td>0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>NaN</td>
            <td>0.0</td>
            <td>-cort-; -ster-; -terone</td>
            <td>0</td>
            <td>-cort-; -ster-; -terone</td>
            <td>cortisone derivatives; steroids (androgens, an...</td>
            <td>Adrenocortical Steroid (salt-regulating)</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>372.51</td>
            <td>4.27</td>
            <td>4.0</td>
            <td>0.0</td>
            <td>60.44</td>
            <td>3.0</td>
            <td>N</td>
            <td>0.0</td>
            <td>None</td>
            <td>None</td>
            <td>3.77</td>
            <td>3.77</td>
            <td>NEUTRAL</td>
            <td>372.51</td>
            <td>0.0</td>
            <td>27.0</td>
            <td>0.69</td>
            <td>372.2301</td>
            <td>C23H32O4</td>
            <td>4.0</td>
            <td>0.0</td>
            <td>0.0</td>
            <td>1.96</td>
            </tr>
            <tr>
            <th>1</th>
            <td>CHEMBL1200728</td>
            <td>Cl.N=C(N)N</td>
            <td>674679</td>
            <td>GUANIDINE HYDROCHLORIDE</td>
            <td>4.0</td>
            <td>1</td>
            <td>1</td>
            <td>MOL</td>
            <td>32735.0</td>
            <td>Small molecule</td>
            <td>1939.0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>2</td>
            <td>0</td>
            <td>0</td>
            <td>NaN</td>
            <td>1.0</td>
            <td>guan-</td>
            <td>0</td>
            <td>guan-</td>
            <td>antihypertensives (guanidine derivatives)</td>
            <td>None</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>59.07</td>
            <td>-1.16</td>
            <td>1.0</td>
            <td>3.0</td>
            <td>75.89</td>
            <td>0.0</td>
            <td>N</td>
            <td>0.0</td>
            <td>None</td>
            <td>12.55</td>
            <td>-1.24</td>
            <td>-3.65</td>
            <td>BASE</td>
            <td>95.53</td>
            <td>0.0</td>
            <td>4.0</td>
            <td>0.24</td>
            <td>59.0483</td>
            <td>CH6ClN3</td>
            <td>3.0</td>
            <td>5.0</td>
            <td>0.0</td>
            <td>0.32</td>
            </tr>
            <tr>
            <th>2</th>
            <td>CHEMBL1200982</td>
            <td>CCC(C)C1(CC)C(=O)[N-]C(=O)NC1=O.[Na+]</td>
            <td>674933</td>
            <td>BUTABARBITAL SODIUM</td>
            <td>4.0</td>
            <td>1</td>
            <td>1</td>
            <td>MOL</td>
            <td>NaN</td>
            <td>Small molecule</td>
            <td>1939.0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>NaN</td>
            <td>1.0</td>
            <td>-barb-</td>
            <td>0</td>
            <td>-barb-</td>
            <td>barbituric acid derivatives</td>
            <td>Sedative-Hypnotic</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>212.25</td>
            <td>0.79</td>
            <td>3.0</td>
            <td>2.0</td>
            <td>75.27</td>
            <td>3.0</td>
            <td>N</td>
            <td>0.0</td>
            <td>7.48</td>
            <td>None</td>
            <td>1.45</td>
            <td>1.19</td>
            <td>NEUTRAL</td>
            <td>234.23</td>
            <td>0.0</td>
            <td>15.0</td>
            <td>0.68</td>
            <td>212.1161</td>
            <td>C10H15N2NaO3</td>
            <td>5.0</td>
            <td>2.0</td>
            <td>0.0</td>
            <td>0.32</td>
            </tr>
            <tr>
            <th>3</th>
            <td>CHEMBL3989520</td>
            <td>NCCc1c[nH]cn1.O=P(O)(O)O.O=P(O)(O)O</td>
            <td>2197391</td>
            <td>HISTAMINE PHOSPHATE</td>
            <td>4.0</td>
            <td>1</td>
            <td>1</td>
            <td>MOL</td>
            <td>NaN</td>
            <td>Small molecule</td>
            <td>1939.0</td>
            <td>0</td>
            <td>1</td>
            <td>0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>2</td>
            <td>0</td>
            <td>0</td>
            <td>NaN</td>
            <td>0.0</td>
            <td>None</td>
            <td>0</td>
            <td>None</td>
            <td>None</td>
            <td>None</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>111.15</td>
            <td>-0.09</td>
            <td>2.0</td>
            <td>2.0</td>
            <td>54.70</td>
            <td>2.0</td>
            <td>Y</td>
            <td>0.0</td>
            <td>None</td>
            <td>9.58</td>
            <td>-0.70</td>
            <td>-2.85</td>
            <td>BASE</td>
            <td>307.14</td>
            <td>1.0</td>
            <td>8.0</td>
            <td>0.56</td>
            <td>111.0796</td>
            <td>C5H15N3O8P2</td>
            <td>3.0</td>
            <td>3.0</td>
            <td>0.0</td>
            <td>0.00</td>
            </tr>
            <tr>
            <th>4</th>
            <td>CHEMBL449</td>
            <td>CCC(C)C1(CC)C(=O)NC(=O)NC1=O</td>
            <td>2393</td>
            <td>BUTABARBITAL</td>
            <td>4.0</td>
            <td>1</td>
            <td>0</td>
            <td>MOL</td>
            <td>3228.0</td>
            <td>Small molecule</td>
            <td>1939.0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>NaN</td>
            <td>1.0</td>
            <td>-barb-</td>
            <td>0</td>
            <td>-barb-</td>
            <td>barbituric acid derivatives</td>
            <td>Sedative-Hypnotic</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>212.25</td>
            <td>0.79</td>
            <td>3.0</td>
            <td>2.0</td>
            <td>75.27</td>
            <td>3.0</td>
            <td>N</td>
            <td>0.0</td>
            <td>7.48</td>
            <td>None</td>
            <td>1.45</td>
            <td>1.19</td>
            <td>NEUTRAL</td>
            <td>212.25</td>
            <td>0.0</td>
            <td>15.0</td>
            <td>0.68</td>
            <td>212.1161</td>
            <td>C10H16N2O3</td>
            <td>5.0</td>
            <td>2.0</td>
            <td>0.0</td>
            <td>0.32</td>
            </tr>
        </tbody>
    </table>
</div>

  </div><a class="u-url" href="/methods/2025-03-29-query-chembl-approved-small-molecule-drugs.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194
                11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0
                13.806c0-1.21.983-2.195 2.194-2.195zM10.606
                16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"
              />
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Laptop Chemistry</li>
          <li><a class="u-email" href="mailto:laptopchemistry@gmail.com">laptopchemistry@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>&quot;Code, compounds, and cures:  Insights from the digital frontier of drug discovery on your laptop.&quot;
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
    <a rel="me" href="https://github.com/brad-dallin" target="_blank" title="GitHub">
      <span class="grey fa-brands fa-github fa-lg"></span>
    </a>
  </li><li>
    <a rel="me" href="https://www.linkedin.com/in/bradley-dallin/" target="_blank" title="LinkedIn">
      <span class="grey fa-brands fa-linkedin fa-lg"></span>
    </a>
  </li></ul>
</div>

  </div>

</footer>

</body>

</html>
